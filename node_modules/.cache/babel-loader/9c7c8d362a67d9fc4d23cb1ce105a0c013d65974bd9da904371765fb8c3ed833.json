{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useRef, useState } from 'react';\nimport { useFetch as tsUseFetch, useLocalStorage } from 'usehooks-ts';\nimport { getHeaderOptions } from '../services';\nimport { useNavigate } from 'react-router-dom';\nconst useFetch = _ref => {\n  _s();\n  let {\n    method = 'GET',\n    url,\n    body,\n    options\n  } = _ref;\n  console.log('--> useFetch url:', url);\n  console.log('--> useFetch body:', body);\n  console.log('--> useFetch options:', options);\n  const [loading, setLoading] = useState(false);\n  const [, setIsLogged] = useLocalStorage(process.env.REACT_APP_LOGGED_KEY, false);\n  const navigate = useNavigate();\n  const [fetchURL, setFetchURL] = useState(url);\n  const postBody = useRef(body);\n  const {\n    data,\n    error\n  } = tsUseFetch(fetchURL, {\n    method,\n    ...(postBody.current && {\n      body: JSON.stringify(postBody.current)\n    }),\n    ...getHeaderOptions(),\n    ...options\n  });\n  const doFetch = _ref2 => {\n    let {\n      url,\n      body\n    } = _ref2;\n    if (body) {\n      postBody.current = body;\n    }\n    setFetchURL(url);\n  };\n  useEffect(() => {\n    if (error) {\n      if (error.message === 'Unauthorized') {\n        setIsLogged(false);\n      }\n      if (error.message === 'Forbidden resource') {\n        navigate('/');\n      }\n      setFetchURL(undefined);\n    }\n  }, [error, navigate, setIsLogged]);\n  return {\n    doFetch,\n    data,\n    error,\n    loading\n  };\n};\n_s(useFetch, \"Ug4VH8MDUKraPnQZmjJN33FkGnE=\", false, function () {\n  return [useLocalStorage, useNavigate];\n});\nexport default useFetch;","map":{"version":3,"names":["useEffect","useRef","useState","useFetch","tsUseFetch","useLocalStorage","getHeaderOptions","useNavigate","_ref","_s","method","url","body","options","console","log","loading","setLoading","setIsLogged","process","env","REACT_APP_LOGGED_KEY","navigate","fetchURL","setFetchURL","postBody","data","error","current","JSON","stringify","doFetch","_ref2","message","undefined"],"sources":["/home/fernando/Documents/develop/www/cpvl/v4_cpvl_2025/cpvl-spa/src/hooks/useFetch.ts"],"sourcesContent":["import { useEffect, useRef, useState } from 'react';\nimport { useFetch as tsUseFetch, useLocalStorage } from 'usehooks-ts';\nimport { getHeaderOptions } from '../services';\nimport { useNavigate } from 'react-router-dom';\n\ninterface IProps {\n  method?: 'POST' | 'GET' | 'PUT' | 'DELETE';\n  url?: string;\n  body?: any;\n  options?: RequestInit;\n}\n\nconst useFetch = <T>({ method = 'GET', url, body, options }: IProps) => {\n  console.log('--> useFetch url:', url);\n  console.log('--> useFetch body:', body);\n  console.log('--> useFetch options:', options);\n  const [loading, setLoading] = useState(false);\n  const [, setIsLogged] = useLocalStorage(\n    process.env.REACT_APP_LOGGED_KEY,\n    false\n  );\n  const navigate = useNavigate();\n  const [fetchURL, setFetchURL] = useState<string | undefined>(url);\n  const postBody = useRef(body);\n  const { data, error } = tsUseFetch<T>(fetchURL, {\n    method,\n    ...(postBody.current && { body: JSON.stringify(postBody.current) }),\n    ...getHeaderOptions(),\n    ...options\n  });\n\n  const doFetch = ({ url, body }: { url: string; body: any }) => {\n    if (body) {\n      postBody.current = body;\n    }\n    setFetchURL(url);\n  };\n\n  useEffect(() => {\n    if (error) {\n      if (error.message === 'Unauthorized') {\n        setIsLogged(false);\n      }\n      if (error.message === 'Forbidden resource') {\n        navigate('/');\n      }\n      setFetchURL(undefined);\n    }\n  }, [error, navigate, setIsLogged]);\n\n  return { doFetch, data, error, loading };\n};\n\nexport default useFetch;\n"],"mappings":";AAAA,SAASA,SAAS,EAAEC,MAAM,EAAEC,QAAQ,QAAQ,OAAO;AACnD,SAASC,QAAQ,IAAIC,UAAU,EAAEC,eAAe,QAAQ,aAAa;AACrE,SAASC,gBAAgB,QAAQ,aAAa;AAC9C,SAASC,WAAW,QAAQ,kBAAkB;AAS9C,MAAMJ,QAAQ,GAAGK,IAAA,IAAuD;EAAAC,EAAA;EAAA,IAAnD;IAAEC,MAAM,GAAG,KAAK;IAAEC,GAAG;IAAEC,IAAI;IAAEC;EAAgB,CAAC,GAAAL,IAAA;EACjEM,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAEJ,GAAG,CAAC;EACrCG,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAEH,IAAI,CAAC;EACvCE,OAAO,CAACC,GAAG,CAAC,uBAAuB,EAAEF,OAAO,CAAC;EAC7C,MAAM,CAACG,OAAO,EAAEC,UAAU,CAAC,GAAGf,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,GAAGgB,WAAW,CAAC,GAAGb,eAAe,CACrCc,OAAO,CAACC,GAAG,CAACC,oBAAoB,EAChC,KACF,CAAC;EACD,MAAMC,QAAQ,GAAGf,WAAW,CAAC,CAAC;EAC9B,MAAM,CAACgB,QAAQ,EAAEC,WAAW,CAAC,GAAGtB,QAAQ,CAAqBS,GAAG,CAAC;EACjE,MAAMc,QAAQ,GAAGxB,MAAM,CAACW,IAAI,CAAC;EAC7B,MAAM;IAAEc,IAAI;IAAEC;EAAM,CAAC,GAAGvB,UAAU,CAAImB,QAAQ,EAAE;IAC9Cb,MAAM;IACN,IAAIe,QAAQ,CAACG,OAAO,IAAI;MAAEhB,IAAI,EAAEiB,IAAI,CAACC,SAAS,CAACL,QAAQ,CAACG,OAAO;IAAE,CAAC,CAAC;IACnE,GAAGtB,gBAAgB,CAAC,CAAC;IACrB,GAAGO;EACL,CAAC,CAAC;EAEF,MAAMkB,OAAO,GAAGC,KAAA,IAA+C;IAAA,IAA9C;MAAErB,GAAG;MAAEC;IAAiC,CAAC,GAAAoB,KAAA;IACxD,IAAIpB,IAAI,EAAE;MACRa,QAAQ,CAACG,OAAO,GAAGhB,IAAI;IACzB;IACAY,WAAW,CAACb,GAAG,CAAC;EAClB,CAAC;EAEDX,SAAS,CAAC,MAAM;IACd,IAAI2B,KAAK,EAAE;MACT,IAAIA,KAAK,CAACM,OAAO,KAAK,cAAc,EAAE;QACpCf,WAAW,CAAC,KAAK,CAAC;MACpB;MACA,IAAIS,KAAK,CAACM,OAAO,KAAK,oBAAoB,EAAE;QAC1CX,QAAQ,CAAC,GAAG,CAAC;MACf;MACAE,WAAW,CAACU,SAAS,CAAC;IACxB;EACF,CAAC,EAAE,CAACP,KAAK,EAAEL,QAAQ,EAAEJ,WAAW,CAAC,CAAC;EAElC,OAAO;IAAEa,OAAO;IAAEL,IAAI;IAAEC,KAAK;IAAEX;EAAQ,CAAC;AAC1C,CAAC;AAACP,EAAA,CAvCIN,QAAQ;EAAA,QAKYE,eAAe,EAItBE,WAAW;AAAA;AAgC9B,eAAeJ,QAAQ"},"metadata":{},"sourceType":"module","externalDependencies":[]}