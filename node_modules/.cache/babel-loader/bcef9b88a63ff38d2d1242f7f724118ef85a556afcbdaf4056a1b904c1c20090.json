{"ast":null,"code":"import _objectSpread from\"/home/fernando/Documents/develop/www/cpvl/v4_cpvl_2025/cpvl-spa/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{Alert,Box,Button,TextField,Typography}from'@mui/material';import{useCallback,useEffect,useState}from'react';import{useNavigate,Link}from'react-router-dom';import{useLocalStorage}from'usehooks-ts';import{API,getURI}from'../../services';import{useFetch}from'../../hooks';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export const Login=()=>{const navigate=useNavigate();const[isLogged,setIsLogged]=useLocalStorage(process.env.REACT_APP_LOGGED_KEY,false);const[loginBody,setLoginBody]=useState({username:'',password:''});const{doFetch:doLogin,data,error}=useFetch({method:'POST'});const[formError,setFormError]=useState();const[isLoading,setIsLoading]=useState(false);useEffect(()=>{if(isLogged){navigate('/');}},[isLogged,navigate]);const clearErrorMessage=useCallback(()=>setFormError(undefined),[]);const handleChange=useCallback(_ref=>{let{target}=_ref;const{value,name}=target;setLoginBody(prevState=>_objectSpread(_objectSpread({},prevState),{},{[name]:value.trim()}));clearErrorMessage();},[clearErrorMessage]);const handleLogin=useCallback(()=>{if(!loginBody.username||!loginBody.password){return setFormError('Preencha os campos corretamente');}setIsLoading(true);doLogin({url:getURI(API.login),body:loginBody});},[doLogin,loginBody]);useEffect(()=>{if(error){setIsLoading(false);setFormError(error.message==='Unauthorized'?'Usuário ou senha incorretos':error.message);}if(data&&data.status==='ok'){setIsLogged(true);}},[error,data,setIsLogged]);return/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',alignItems:'center',minHeight:'84vh'},children:/*#__PURE__*/_jsxs(Box,{sx:{width:'100%',maxWidth:400,padding:3,borderRadius:2,boxShadow:3},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",align:\"center\",mb:2,children:\"CPVL\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",align:\"center\",mb:4,children:\"Bem-vindo ao portal de servi\\xE7os administrativos. Entre com o seu usu\\xE1rio e senha para continuar.\"}),/*#__PURE__*/_jsx(Box,{sx:{marginBottom:2},children:/*#__PURE__*/_jsx(TextField,{variant:\"outlined\",value:loginBody.username,name:\"username\",label:\"Usu\\xE1rio\",onChange:handleChange,onFocus:clearErrorMessage,fullWidth:true})}),/*#__PURE__*/_jsx(Box,{sx:{marginBottom:2},children:/*#__PURE__*/_jsx(TextField,{variant:\"outlined\",value:loginBody.password,name:\"password\",type:\"password\",label:\"Senha\",onChange:handleChange,onFocus:clearErrorMessage,fullWidth:true})}),/*#__PURE__*/_jsx(Button,{disabled:isLoading,variant:\"contained\",color:\"primary\",onClick:handleLogin,fullWidth:true,size:\"large\",sx:{bgcolor:'#1f5388',marginBottom:2},children:\"Entrar\"}),formError&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{marginBottom:2},children:formError}),/*#__PURE__*/_jsx(Box,{sx:{marginTop:2},children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:/*#__PURE__*/_jsx(Link,{to:\"/rescuePassword\",style:{textDecoration:'underline',color:'#1f5388'},children:\"Esqueceu a senha?\"})})}),/*#__PURE__*/_jsx(Box,{sx:{marginTop:1},children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[\"N\\xE3o tem conta?\",' ',/*#__PURE__*/_jsx(Link,{to:\"/signup\",style:{textDecoration:'underline',color:'#1f5388'},children:\"Cadastre-se\"})]})})]})});};","map":{"version":3,"names":["Alert","Box","Button","TextField","Typography","useCallback","useEffect","useState","useNavigate","Link","useLocalStorage","API","getURI","useFetch","jsx","_jsx","jsxs","_jsxs","Login","navigate","isLogged","setIsLogged","process","env","REACT_APP_LOGGED_KEY","loginBody","setLoginBody","username","password","doFetch","doLogin","data","error","method","formError","setFormError","isLoading","setIsLoading","clearErrorMessage","undefined","handleChange","_ref","target","value","name","prevState","_objectSpread","trim","handleLogin","url","login","body","message","status","sx","display","justifyContent","alignItems","minHeight","children","width","maxWidth","padding","borderRadius","boxShadow","variant","align","mb","marginBottom","label","onChange","onFocus","fullWidth","type","disabled","color","onClick","size","bgcolor","severity","marginTop","to","style","textDecoration"],"sources":["/home/fernando/Documents/develop/www/cpvl/v4_cpvl_2025/cpvl-spa/src/components/Login/Login.component.tsx"],"sourcesContent":["import { Alert, Box, Button, TextField, Typography } from '@mui/material';\nimport { useCallback, useEffect, useState } from 'react';\nimport { useNavigate, Link } from 'react-router-dom';\nimport { useLocalStorage } from 'usehooks-ts';\nimport { API, getURI } from '../../services';\nimport { useFetch } from '../../hooks';\n\ninterface ILoginBody {\n  username: string;\n  password: string;\n}\n\ninterface IApiResponse {\n  status: string;\n}\n\nexport const Login = () => {\n  const navigate = useNavigate();\n  const [isLogged, setIsLogged] = useLocalStorage(\n    process.env.REACT_APP_LOGGED_KEY,\n    false\n  );\n  const [loginBody, setLoginBody] = useState<ILoginBody>({\n    username: '',\n    password: ''\n  });\n  const {\n    doFetch: doLogin,\n    data,\n    error\n  } = useFetch<IApiResponse>({ method: 'POST' });\n  const [formError, setFormError] = useState<string | undefined>();\n  const [isLoading, setIsLoading] = useState(false);\n\n  useEffect(() => {\n    if (isLogged) {\n      navigate('/');\n    }\n  }, [isLogged, navigate]);\n\n  const clearErrorMessage = useCallback(() => setFormError(undefined), []);\n\n  const handleChange = useCallback(\n    ({ target }: React.ChangeEvent<HTMLInputElement>) => {\n      const { value, name } = target;\n      setLoginBody((prevState) => ({\n        ...prevState,\n        [name]: value.trim()\n      }));\n      clearErrorMessage();\n    },\n    [clearErrorMessage]\n  );\n\n  const handleLogin = useCallback(() => {\n    if (!loginBody.username || !loginBody.password) {\n      return setFormError('Preencha os campos corretamente');\n    }\n    setIsLoading(true);\n    doLogin({ url: getURI(API.login), body: loginBody });\n  }, [doLogin, loginBody]);\n\n  useEffect(() => {\n    if (error) {\n      setIsLoading(false);\n      setFormError(\n        error.message === 'Unauthorized'\n          ? 'Usuário ou senha incorretos'\n          : error.message\n      );\n    }\n    if (data && data.status === 'ok') {\n      setIsLogged(true);\n    }\n  }, [error, data, setIsLogged]);\n\n  return (\n    <Box\n      sx={{\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center',\n        minHeight: '84vh'\n      }}\n    >\n      <Box\n        sx={{\n          width: '100%',\n          maxWidth: 400,\n          padding: 3,\n          borderRadius: 2,\n          boxShadow: 3\n        }}\n      >\n        <Typography variant=\"h4\" align=\"center\" mb={2}>\n          CPVL\n        </Typography>\n        <Typography variant=\"body2\" align=\"center\" mb={4}>\n          Bem-vindo ao portal de serviços administrativos. Entre com o seu\n          usuário e senha para continuar.\n        </Typography>\n\n        <Box sx={{ marginBottom: 2 }}>\n          <TextField\n            variant=\"outlined\"\n            value={loginBody.username}\n            name=\"username\"\n            label=\"Usuário\"\n            onChange={handleChange}\n            onFocus={clearErrorMessage}\n            fullWidth\n          />\n        </Box>\n\n        <Box sx={{ marginBottom: 2 }}>\n          <TextField\n            variant=\"outlined\"\n            value={loginBody.password}\n            name=\"password\"\n            type=\"password\"\n            label=\"Senha\"\n            onChange={handleChange}\n            onFocus={clearErrorMessage}\n            fullWidth\n          />\n        </Box>\n\n        <Button\n          disabled={isLoading}\n          variant=\"contained\"\n          color=\"primary\"\n          onClick={handleLogin}\n          fullWidth\n          size=\"large\"\n          sx={{ bgcolor: '#1f5388', marginBottom: 2 }}\n        >\n          Entrar\n        </Button>\n\n        {formError && (\n          <Alert severity=\"error\" sx={{ marginBottom: 2 }}>\n            {formError}\n          </Alert>\n        )}\n\n        <Box sx={{ marginTop: 2 }}>\n          <Typography variant=\"body2\">\n            <Link\n              to=\"/rescuePassword\"\n              style={{ textDecoration: 'underline', color: '#1f5388' }}\n            >\n              Esqueceu a senha?\n            </Link>\n          </Typography>\n        </Box>\n\n        <Box sx={{ marginTop: 1 }}>\n          <Typography variant=\"body2\">\n            Não tem conta?{' '}\n            <Link\n              to=\"/signup\"\n              style={{ textDecoration: 'underline', color: '#1f5388' }}\n            >\n              Cadastre-se\n            </Link>\n          </Typography>\n        </Box>\n      </Box>\n    </Box>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}